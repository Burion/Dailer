@using DailerApp.Models;
@model DailerApp.Models.IndexModel
@{
    ViewData["Title"] = "Home Page";
}
<head>
    <link rel="stylesheet" type="text/css" href = "css/site.css">
</head>
<div class="text-center">
    <h1>Welcome back, @Model.Title</h1>
    
</div>

<div class="container" >
    <div>
        <canvas id="marksChart"></canvas>
    </div>
    
    <div style="display: flex; flex-direction: column; border: 1px solid black; border-radius: 15px;">
        @foreach(var trait in Model.Traits)
        {
            
            <div class="container">
            <div style="width: 100%"><p>@trait.Title</p></div>

            <div class="container">
                @for(int x = 1; x <= 5; x++)
                {
                <p onclick="setMark(@trait.Id, @x), updateChart()">☆</p>
                }
                </div>
            <!--"★" : "☆"-->
            </div>
        }
        </div>
</div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.js"></script>
<script>
    var radarChart;
</script>
<script language=javascript type="text/javascript">

function radialChart(){
  $.ajax(
    {
        type: "GET",
        url: '/getstring',
        success: function (response) {
            printChart(response);
            //updateChart();
    }
    });
    }
</script>
<script>
    radialChart();
</script>
<script>
    function printChart(_lb)
    {
        var marksCanvas = document.getElementById("marksChart");
        var data1 = _lb[1].map(function(item) {
        return parseInt(item, 10);
        });
        
        var data2 = _lb[2].map(function(item) {
        return parseInt(item, 10);
        });
        var marksData = {
        labels: _lb[0],
        datasets: [{
            label: "January",
            backgroundColor: "rgba(200,0,0,0.2)",
            data: data1
        }]
        };

        radarChart = new Chart(marksCanvas, {
        type: 'radar',
        data: marksData
        });

        
    }
</script>

<script>
    function updateChart(){
        $.ajax(
        {
        type: "GET",
        url: '/getstring',
        success: function (response) {
            var _data = response[1].map(function(item) {
            return parseInt(item, 10);
        });
        radarChart.data.datasets[0].data = _data;
        }
        });
        radarChart.update();
    }
</script>
<script>
    function setMark(trait, mark)
    {
       $.ajax(
        {
        type: "POST",
        url: '/setmark/' + trait + "/" + mark
    }); 
    }
    
</script>

<script type="text/javascript">
        $(document).ready(function () {

            $('#butt').click(function () {
                $.ajax(
                {
                type: "POST",
                url: '/setmark/' + 4,
                success: function(response)
                {
                    
                    updateChart();
                }
                }); 
            });
        });
</script>

<fieldset>
     <input type="button" value="Demo 1" id="butt" />
</fieldset>

